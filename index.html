<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Cloud Factory Fridge Dashboard</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 2rem;
        background-color: #f8f8f8;
        text-align: center;
      }
      h1 {
        font-size: 2.5rem;
        margin-bottom: 2rem;
      }
      .fridge {
        background: white;
        padding: 1.5rem;
        margin: 1rem auto;
        max-width: 500px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .name {
        font-weight: bold;
        font-size: 1.2rem;
        margin-bottom: 0.5rem;
      }
      .temp {
        font-size: 2rem;
      }
    </style>
  </head>
  <body>
    <h1>Cloud Factory Fridge Dashboard</h1>

    <div class="fridge">
      <div class="name" id="kitchen-name">Loading...</div>
      <div class="temp" id="kitchen-temp">-- 째C</div>
    </div>

    <div class="fridge">
      <div class="name" id="pizza1-name">Loading...</div>
      <div class="temp" id="pizza1-temp">-- 째C</div>
    </div>

    <div class="fridge">
      <div class="name" id="pizza2-name">Loading...</div>
      <div class="temp" id="pizza2-temp">-- 째C</div>
    </div>

    <script>
      async function fetchFridgeData() {
        try {
          const res = await fetch('/api/fridge-data');
          const data = await res.json();

          const update = (id, info) => {
            if (info && !info.error) {
              document.getElementById(`${id}-name`).innerText = info.name;
              document.getElementById(`${id}-temp`).innerText = `${info.state} 째C`;
            } else {
              document.getElementById(`${id}-name`).innerText = 'Error';
              document.getElementById(`${id}-temp`).innerText = '--';
            }
          };

          update('kitchen', data.kitchen);
          update('pizza1', data.pizza1);
          update('pizza2', data.pizza2);
        } catch (err) {
          console.error('Failed to load fridge data:', err);
        }
      }

      fetchFridgeData();
      setInterval(fetchFridgeData, 60_000); // refresh every 60s
    </script>
  </body>
</html>
